# Qwen3-0.6B QLoRA Web应用使用说明

## 概述

本Web应用为Qwen3-0.6B QLoRA微调项目提供了完整的图形化界面，包括对话交互、训练监控、模型管理等功能。

## 功能特性

### 🚀 主要功能
- **智能对话**: 与微调后的模型进行实时对话交互
- **训练监控**: 实时监控训练进度和损失变化
- **模型管理**: 管理和切换不同的微调模型
- **日志查看**: 查看详细的训练和运行日志

### 🎯 技术特点
- **响应式设计**: 支持桌面和移动设备
- **实时通信**: 基于WebSocket的实时状态更新
- **可视化图表**: 训练损失曲线图表
- **现代界面**: 美观的Material Design风格

## 快速开始

### 1. 环境准备

确保已安装以下依赖：
```bash
pip install -r requirements.txt
```

### 2. 启动应用

#### Windows用户
双击运行 `start_web.bat` 文件

#### 或手动启动
```bash
python start_web.py
```

### 3. 访问应用

打开浏览器访问：`http://127.0.0.1:8000`

## 界面说明

### 侧边栏导航

#### 📱 状态面板
- **模型状态**: 显示当前加载的模型状态
- **训练状态**: 显示训练进程状态

#### 🧭 导航菜单
- **对话**: 与AI模型进行对话交互
- **训练**: 配置和监控模型训练
- **模型管理**: 管理已训练的模型
- **日志**: 查看系统运行日志

### 对话界面

#### 💬 功能特性
- **实时对话**: 支持多轮对话交互
- **参数调节**: 可调整生成参数
  - `最大生成长度`: 控制回复长度 (50-500)
  - `温度`: 控制生成随机性 (0.1-1.0)
  - `Top-p`: 控制词汇选择范围 (0.1-1.0)

#### 🔧 操作功能
- **清空对话**: 清除所有对话历史
- **导出对话**: 将对话保存为文本文件

### 训练界面

#### ⚙️ 训练配置
- **训练轮次**: 设置训练的epoch数量
- **批量大小**: 设置每批次的样本数量
- **学习率**: 设置模型学习率

#### 📊 进度监控
- **实时进度**: 显示当前训练步数和总步数
- **损失曲线**: 实时显示训练损失变化
- **状态控制**: 开始/停止训练操作

### 模型管理

#### 🧠 模型列表
- 显示所有可用的微调模型
- 查看模型大小和修改时间
- 一键加载切换模型

#### 🔄 模型操作
- **刷新列表**: 重新扫描模型目录
- **加载模型**: 切换到指定模型

### 日志界面

#### 📝 日志功能
- **实时日志**: 显示最新的训练日志
- **自动滚动**: 自动滚动到最新日志
- **刷新更新**: 手动刷新日志内容

## 使用流程

### 首次使用

1. **确保模型已训练**
   - 确保 `outputs/` 目录下有微调模型
   - 如果没有，请先运行 `python train.py` 进行训练

2. **启动Web应用**
   - 运行启动脚本或命令
   - 等待服务器启动完成

3. **访问界面**
   - 打开浏览器访问应用
   - 检查模型加载状态

### 对话使用

1. **选择对话标签**
2. **调整生成参数**（可选）
3. **输入消息**并发送
4. **查看AI回复**
5. **继续多轮对话**

### 训练监控

1. **切换到训练标签**
2. **配置训练参数**
3. **点击开始训练**
4. **实时监控进度**
5. **查看损失曲线**

### 模型管理

1. **切换到模型管理标签**
2. **查看可用模型列表**
3. **选择并加载模型**
4. **确认加载状态**

## 配置说明

### 服务器配置

在 `web_config.py` 中可以修改：
```python
HOST = "127.0.0.1"      # 服务器地址
PORT = 8000              # 服务器端口
RELOAD = True            # 开发模式
```

### 安全配置

```python
CORS_ORIGINS = ["*"]              # CORS设置
MAX_MESSAGE_LENGTH = 2000         # 最大消息长度
MAX_HISTORY_LENGTH = 20           # 最大历史记录长度
```

### 默认参数

```python
DEFAULT_MAX_TOKENS = 100          # 默认最大token数
DEFAULT_TEMPERATURE = 0.3         # 默认温度
DEFAULT_TOP_P = 0.8              # 默认top-p值
```

## API接口

### RESTful API

- `GET /api/health` - 健康检查
- `POST /api/chat` - 发送对话消息
- `GET /api/models` - 获取模型列表
- `POST /api/load_model/{name}` - 加载指定模型
- `POST /api/training/start` - 开始训练
- `POST /api/training/stop` - 停止训练
- `GET /api/training/status` - 获取训练状态
- `GET /api/training/logs` - 获取训练日志

### WebSocket API

- `/ws` - WebSocket连接
- 支持实时状态推送和心跳检测

## 故障排除

### 常见问题

#### 1. 模型未加载
- **问题**: 模型状态显示"未加载"
- **解决**: 确保 `outputs/` 目录下有微调模型，或重新训练

#### 2. 端口被占用
- **问题**: 启动失败，提示端口被占用
- **解决**: 修改 `web_config.py` 中的端口号

#### 3. 依赖缺失
- **问题**: 启动时提示缺少依赖
- **解决**: 运行 `pip install -r requirements.txt`

#### 4. 内存不足
- **问题**: 模型加载失败，显存不足
- **解决**: 减少batch size或使用更小的模型

### 日志查看

- **Web应用日志**: `web_app.log`
- **训练日志**: `training.log`
- **浏览器控制台**: F12打开开发者工具

## 开发说明

### 文件结构

```
├── app.py              # FastAPI主应用
├── web_config.py       # Web配置文件
├── start_web.py        # 启动脚本
├── start_web.bat       # Windows启动脚本
└── web/                # 前端文件
    ├── index.html      # 主页面
    ├── style.css       # 样式文件
    └── script.js       # JavaScript逻辑
```

### 自定义开发

1. **修改界面**: 编辑 `web/` 目录下的文件
2. **添加API**: 在 `app.py` 中添加新的路由
3. **修改配置**: 编辑 `web_config.py`

## 更新日志

- **v1.0.0**: 初始版本
  - 基础对话功能
  - 训练监控
  - 模型管理
  - 实时日志查看

## 技术支持

如遇问题，请查看：
1. **日志文件**: 查看详细错误信息
2. **GitHub Issues**: 提交问题反馈
3. **文档说明**: 仔细阅读使用说明

---

**享受您的AI对话体验！** 🤖✨